<?xml version="1.0" encoding="UTF-8"?>
<!--there is still a bug in simulation model Include file - it needs a comment infron of it-->
<SimulationModelIncludeFile>
	<!--PlantTemplate-->
	<SimulaDirective path="/plantTemplate">
		<SimulaBase name="nitrate">
			<SimulaDerivative name="plantOptimalNutrientContent" unit="uMol" function="plantTotal" />
			<SimulaDerivative name="plantMinimalNutrientContent" unit="uMol" function="plantTotal" />
			<SimulaVariable name="plantNutrientUptake" unit="uMol" function="plantTotal" integrationFunction="HeunsII" />
			<!--SimulaDerivative name="nutrientStressFactor" unit="100%" function="nutrientStressFactor" /-->
			<SimulaVariable name="nutrientStressFactor" unit="100%" function="nutrientStressFactor.V2" />
		</SimulaBase>
	</SimulaDirective>

	<!--ShootTemplate-->
	<SimulaDirective path="/shootTemplate">
		<SimulaBase name="nitrate">
			<SimulaLink name="leafOptimalNutrientConcentration" unit="uMol/g"	/>
			<SimulaDerivative name="leafOptimalNutrientContent" unit="uMol" function="leafOptimalNutrientContent" />
			<SimulaLink name="leafMinimalNutrientConcentration" unit="uMol/g"	/>
			<SimulaDerivative name="leafMinimalNutrientContent" unit="uMol" function="leafMinimalNutrientContent" />
			<SimulaConstant name="leafNutrientUptake" unit="uMol">0</SimulaConstant>
			<SimulaLink name="stemOptimalNutrientConcentration" unit="uMol/g"  />
			<SimulaDerivative name="stemOptimalNutrientContent" unit="uMol" function="stemOptimalNutrientContent" />
			<SimulaLink name="stemMinimalNutrientConcentration" unit="uMol/g"  />
			<SimulaDerivative name="stemMinimalNutrientContent" unit="uMol" function="stemMinimalNutrientContent" />
			<SimulaConstant name="stemNutrientUptake" unit="uMol">0</SimulaConstant>
		</SimulaBase>
	</SimulaDirective>

	<!--HypocotylTemplate-->
	<SimulaDirective path="/hypocotylTemplate">
		<SimulaDirective path="growthpoint">
			<SimulaBase name="nitrate">
				<!--nutrientFluxDensity from the growthpoint should be always zero-->
				<SimulaConstant name="nutrientFluxDensity" unit="uMol/cm"> 0 </SimulaConstant> 
				<SimulaConstant	name="rootSegmentNutrientUptake" unit="uMol"> 0 </SimulaConstant>
				<SimulaLink name="optimalNutrientConcentration" unit="uMol/g" />
				<SimulaLink name="minimalNutrientConcentration" unit="uMol/g" />
				<SimulaConstant name="rootSegmentOptimalNutrientContent" unit="uMol">0 </SimulaConstant>
				<SimulaConstant name="rootSegmentMinimalNutrientContent" unit="uMol">0 </SimulaConstant>
			</SimulaBase>
		</SimulaDirective>
		<SimulaBase name="nitrate">
			<SimulaDerivative name="rootOptimalNutrientContent" unit="uMol" function="rootTotal.v2" />
			<SimulaDerivative name="rootSystemOptimalNutrientContent" unit="uMol" function="rootSystemTotal" />
			<SimulaDerivative name="rootMinimalNutrientContent" unit="uMol" function="rootTotal.v2" />
			<SimulaDerivative name="rootSystemMinimalNutrientContent" unit="uMol" function="rootSystemTotal" />
			<SimulaVariable name="rootNutrientUptake" unit="uMol" function="rootTotal.v2" integrationFunction="HeunsII"/>
			<SimulaVariable name="rootSystemNutrientUptake" unit="uMol" function="rootSystemTotal" integrationFunction="HeunsII" />
		</SimulaBase>
	</SimulaDirective>

	<!--Sibling root template-->
	<SimulaDirective path="/siblingRootTemplate">
		<SimulaDirective path="growthpoint">
			<!--nutrientFluxDensity from the growthpoint should be always zero-->
			<SimulaBase name="nitrate">
				<SimulaConstant name="nutrientFluxDensity" unit="uMol/cm"> 0 </SimulaConstant> 
				<SimulaConstant	name="rootSegmentNutrientUptake" unit="uMol"> 0 </SimulaConstant>
				<SimulaLink name="optimalNutrientConcentration" unit="uMol/g"  />
				<SimulaConstant name="rootSegmentOptimalNutrientContent" unit="uMol">0 </SimulaConstant>
				<SimulaLink name="minimalNutrientConcentration" unit="uMol/g"  />
				<SimulaConstant name="rootSegmentMinimalNutrientContent" unit="uMol">0 </SimulaConstant>
			</SimulaBase>
		</SimulaDirective>
		<SimulaBase name="nitrate">
			<SimulaDerivative name="rootOptimalNutrientContent" unit="uMol" function="rootTotal.v2" />
			<SimulaDerivative name="rootSystemOptimalNutrientContent" unit="uMol" function="rootSystemTotal" />
			<SimulaDerivative name="rootMinimalNutrientContent" unit="uMol" function="rootTotal.v2" />
			<SimulaDerivative name="rootSystemMinimalNutrientContent" unit="uMol" function="rootSystemTotal" />
			<SimulaVariable name="rootNutrientUptake" unit="uMol" function="rootTotal.v2"  integrationFunction="HeunsII" />
			<SimulaVariable name="rootSystemNutrientUptake" unit="uMol" function="rootSystemTotal" integrationFunction="HeunsII" />
		</SimulaBase>
	</SimulaDirective>

	<!--DataPointTemplate-->
	<SimulaDirective path="/dataPointTemplate">
		<SimulaBase name="nitrate">
			<!--note that this needs to use HeunsII-->
			<!--note choosing the timestep parameters right will effect computational time greatly -- especially sinking right will help a lot so don't play to much with the minTimeStep -->
			<SimulaVariable name="nutrientFluxDensity" unit="uMol/cm" preferedTimeStep="0.0051" minTimeStep="0.005" maxTimeStep="0.005" syncTimeStep="false" integrationFunction="HeunsII" function="barber_cushman_1981_nutrient_uptake" />
			<!--SimulaConstant name="nutrientFluxDensity" unit="uMol/cm" >0.5</SimulaConstant-->
			<SimulaVariable	name="rootSegmentNutrientUptake" unit="uMol" XpreferedTimeStep="0.1" integrationFunction="HeunsII" function="spatialIntegral"/>
			<!--SimulaDerivative name="radiusDepletionZone" unit="cm" function="radiusDepletionZoneSimRoot4" /-->
			<SimulaTable name_colum1="time" name_colum2="radiusDepletionZone" unit_colum1="day" unit_colum2="cm" function="radiusDepletionZoneBarberCushman" > 0 0 </SimulaTable>
			<SimulaLink name="optimalNutrientConcentration" unit="uMol/g"  />
			<SimulaLink name="minimalNutrientConcentration" unit="uMol/g"  />
			<SimulaDerivative name="rootSegmentOptimalNutrientContent" unit="uMol" function="rootSegmentOptimalNutrientContent" />
			<SimulaDerivative name="rootSegmentMinimalNutrientContent" unit="uMol" function="rootSegmentMinimalNutrientContent" />
		</SimulaBase>
	</SimulaDirective>

</SimulationModelIncludeFile>

